#!/bin/bash
{{ if eq .chezmoi.os "linux" -}}

{{ if eq .chezmoi.osRelease.id "arch"}}
PACMAN_PKGS=(
    nodejs # CoC support
    chezmoi
    neovim
    tmux
    fzf
    zoxide
    fd
    bat
    ripgrep
    lsd
)
sudo pacman -S ${PACKAGES[@]}
BREW_PKGS=()
{{ end }}

{{ if eq .chezmoi.osRelease.id "ubuntu"}}

APT_PKGS=(
    build-essential
    procps
    curl
    file
    git
    zsh
)

# Install packages
sudo apt-get update
sudo apt-get install -y ${APT_PKGS[@]}
BREW_PKGS=(
    chezmoi
    neovim
    tmux
    fzf
    zoxide
    fd
    bat
    ripgrep
    lsd
)

{{ end }}
if [ ${#BREW_PKGS[@]} -ne 0 ]; then
    # If Homebrew is not installed on the system, it will be installed here
    if test ! $(which brew); then
       printf '\n\n\e[33mHomebrew not found. \e[0mInstalling Homebrew...'
       /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"
       eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
    else
      printf '\n\n\e[0mHomebrew found. Continuing...'
    fi

    brew update
    brew install ${BREW_PKGS[@]}
    brew cleanup
fi
{{ end }}
